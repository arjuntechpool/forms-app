<form #form="ngForm" (ngSubmit)="onSubmit(form)" aria-label="Registration Form">
  <div class="form-grid">
    <!-- Name Field -->
    <mat-form-field>
      <mat-label>Name</mat-label>
      <input
        matInput
        placeholder="Ex. John"
        name="name"
        ngModel
        required
        #nameInput="ngModel"
        aria-required="true"
      />
      <mat-error *ngIf="nameInput.invalid && nameInput.touched">
        Name is required
      </mat-error>
    </mat-form-field>

    <!-- Email Field -->
    <mat-form-field>
      <mat-label>Email</mat-label>
      <input
        matInput
        placeholder="Ex. pat@example.com"
        name="email"
        ngModel
        required
        email
        #emailInput="ngModel"
        aria-required="true"
      />
      <mat-error *ngIf="emailInput.invalid && emailInput.touched">
        Please enter a valid email address
      </mat-error>
    </mat-form-field>

    <!-- Date Field -->
    <mat-form-field>
      <mat-label>Choose a date</mat-label>
      <input
        matInput
        [matDatepicker]="picker"
        name="date"
        ngModel
        placeholder="MM/DD/YYYY"
      />
      <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
      <mat-datepicker #picker></mat-datepicker>
    </mat-form-field>

    <!-- Gender Selection -->
    <div class="form-group" role="group" aria-label="Gender selection">
      <mat-label>Gender</mat-label>
      <mat-radio-group [(ngModel)]="gender" name="gender" class="gender-group">
        <mat-radio-button value="1">Male</mat-radio-button>
        <mat-radio-button value="2">Female</mat-radio-button>
      </mat-radio-group>
    </div>

    <!-- Buy or Rent Selection -->
    <section class="example-section" role="group" aria-label="Buy or rent selection">
      <mat-label>Buy or rent</mat-label>
      <mat-checkbox [(ngModel)]="buy" name="buy" class="example-margin">
        Buy
      </mat-checkbox>
      <mat-checkbox [(ngModel)]="rent" name="rent" class="example-margin">
        Rent
      </mat-checkbox>
    </section>

    <!-- Address Section -->
    <div class="form-group">
      <mat-label>Address</mat-label>
      <section class="address-grid">
        <!-- House Name -->
        <mat-form-field appearance="fill">
          <mat-label>House Name</mat-label>
          <input
            matInput
            placeholder="Ex. Bethel"
            name="houseName"
            ngModel
          />
        </mat-form-field>

        <!-- Main Place -->
        <mat-form-field appearance="fill">
          <mat-label>Main Place</mat-label>
          <input
            matInput
            placeholder="Ex. Ulloor"
            name="mainPlace"
            ngModel
          />
        </mat-form-field>

        <!-- Post -->
        <mat-form-field appearance="fill">
          <mat-label>Post</mat-label>
          <input
            matInput
            placeholder="Ex. Post Office"
            name="post"
            ngModel
          />
        </mat-form-field>

        <!-- PIN -->
        <mat-form-field appearance="fill">
          <mat-label>PIN</mat-label>
          <input
            matInput
            type="number"
            placeholder="Ex. 695581"
            name="pin"
            ngModel
          />
        </mat-form-field>

        <!-- State Selection -->
        <mat-form-field>
          <mat-label>Select State</mat-label>
          <mat-select
            [(ngModel)]="selectedState"
            name="state"
            (selectionChange)="onStateChange($event.value)"

          >
            <mat-option *ngFor="let state of states" [value]="state">
              {{state}}
            </mat-option>
          </mat-select>
        </mat-form-field>

        <!-- District Selection -->
        <mat-form-field>
          <mat-label>Select District</mat-label>
          <mat-select
            [(ngModel)]="selectedDistrict"
            name="district"
            [disabled]="!filteredDistricts.length"
          >
            <mat-option *ngFor="let district of filteredDistricts" [value]="district">
              {{district}}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </section>
    </div>
  </div>

  <!-- Form Buttons -->
  <div class="button-group">
    <button
      mat-raised-button
      color="primary"
      type="submit"
      [disabled]="form.invalid"
    >
      {{editIndex !== null ? 'Update' : 'Register'}}
    </button>
    <!-- <button
      mat-raised-button
      color="accent"
      type="button"
      (click)="showResults()"
    >
      Show Results
    </button> -->
  </div>
</form>

<!-- Results Table -->
<table *ngIf="showTable && formResults.length > 0" class="example-table" aria-label="Form Results">
  <thead>
    <tr>
      <th>Name</th>
      <th>Email</th>
      <th>Date</th>
      <th>Gender</th>
      <th>Preference</th>
      <th>House Name</th>
      <th>Main Place</th>
      <th>Post</th>
      <th>Pin</th>
      <th>State</th>
      <th>District</th>
      <th>Actions</th>
    </tr>
  </thead>
  <tbody>
    <tr *ngFor="let result of formResults; let i = index">
      <td>{{ result.name }}</td>
      <td>{{ result.email }}</td>
      <td>{{ result.date | date : "dd/MM/yyyy" }}</td>
      <td>{{ result.gender === "1" ? "Male" : "Female" }}</td>
      <td>
        {{ result.buy ? "Buy" : "" }}
        {{ result.rent ? "Rent" : "" }}
        {{ !result.buy && !result.rent ? "None" : "" }}
      </td>
      <td>{{ result.houseName }}</td>
      <td>{{ result.mainPlace }}</td>
      <td>{{ result.post }}</td>
      <td>{{ result.pin }}</td>
      <td>{{ result.state }}</td>
      <td>{{ result.district }}</td>
      <td>
        <button mat-button color="primary" (click)="editEntry(i)">Edit</button>
      </td>
    </tr>
  </tbody>
</table>
